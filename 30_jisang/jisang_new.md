# 지상(Jisang) 신규 작업 체크리스트 (jisang_new.md)

이 문서는 사용자와 AI가 함께 진행할 작업의 단계별 계획표입니다.
**원칙**: `style.css`, `script.js` 수정 최소화, HTML 파일 내 `style` 및 `script` 활용.

## 1. [landing.html] 상단 및 지도 개선
- [x] **상단 제목(Header) 수정**: 프로젝트의 css코드와 유사한 디자인으로 변경. 디자인 충돌이 일어나지 않게 잘 확인 필요.
- [x] **로그인 상태 표시 기능**: 로그인 시 사용자 이름 또는 아이콘 표시 (비로그인 시 로그인 버튼 유지)
- [x] **지도 API 환경 개선**: 로컬(`localhost`) 및 배포 환경 모두에서 네이버/구글 지도가 정상 작동하도록 설정 점검 (확인 결과: SVG 방식이라 별도 API 설정 불필요)

## 2. [auth_modal.html] 회원가입 및 로그인 로직 개선
- [x] **이메일 형식 강제 (Validation)**:
    - [x] 아이디 입력 칸에 `type="email"` 적용
    - [x] 정규표현식을 사용하여 이메일 형식이 아닐 경우 가입 차단 안내
- [ ] **엔터키(Enter) 로그인**: 이메일/비밀번호 입력 후 엔터 키 입력 시 '로그인' 버튼 클릭 이벤트 트리거
- [ ] **지역(Region) 데이터 저장 오류 수정**: 회원가입 시 선택한 지역 정보가 DB에 누락되는 원인 디버깅 및 수정

## 3. [nav.html] 네비게이션 및 추천/알림 시스템
- [ ] **네비게이션 순서 재배치**:
    - [ ] 변경 전: (현재 순서)
    - [ ] 변경 후: **Home** -> **Mypage** -> **All Policies** -> **About**
- [ ] **알림 뱃지(Badge) & 말풍선**:
    - [ ] 알림 아이콘에 빨간 점(Badge) 추가
    - [ ] 클릭 시 말풍선 표시 및 뱃지 제거 로직 구현
- [ ] **알림 데이터 스키마 설계**: 알림/추천 기능을 위한 클라이언트/서버 데이터 구조 정의
- [ ] **추천 및 리마인드 알고리즘 구현**:
    - [ ] **관심사 기반 추천**: "최근 본 '청년 수당'과 유사한 '취업 장려금' 추천"
    - [ ] **유사 사용자 기반(Collaborative Filtering)**: "나와 비슷한 A님이 신청한 정책 추천"
    - [ ] **마감 임박 리마인드**: "찜해둔 정책 마감 3일 전 알림"

## 상세 작업 이력 (Work Log)

### [2026-01-05] landing.html UI 개선
1.  **상단 제목(Header) 디자인 변경**
    - `main.html`의 CSS 스타일(`text-4xl md:text-5xl font-extrabold`)을 가져와 적용.
    - 문구 변경: "쓱-쓱 훑어 보는 청년 정책 소식"
    - `script.js` 내에서 타이틀을 덮어쓰던 로직 수정 (`national` 뷰일 때만 커스텀 타이틀 적용).

2.  **로그인 상태 표시 기능 구현**
    - `nav.html`과 별개로 랜딩 페이지 우측 상단에 `loading` 상태 표시 배지 추가 (`#user-status`).
    - `localStorage`의 `userName` 유무를 확인하여 로그인 시 배지를 표시하고 이름 출력.

3.  **지도 API 환경 호환성 점검**
    - 코드 확인 결과, 현재 지도는 외부 Map API(Google/Naver)가 아닌 **SVG 벡터 이미지(`map.svg`)** 방식을 사용 중입니다.
    - 배포 환경(비-로컬)에서도 별도의 API Key 설정 없이 정상 작동하므로 추가 작업이 필요 없습니다. (완료 처리)

3.  **검증 스크립트(`debug_signup.py`) 테스트 결과**
    - 별도 스크립트로 회원가입 로직 실행 시 **성공**.
    - 즉, 코드는 정상이나 **서버 프로세스가 패키지 설치 내역을 반영하지 못함** (재시작 필요).

## 4. [landing.html] 레이아웃 조정
- [ ] **컨테이너 패딩 추가**: 
    - 헤더와 지도가 화면에 잘리지 않도록 상하 패딩(padding-y)을 넉넉하게 추가.
    - `h-screen`(화면 꽉 채움) 속성 때문에 내용이 넘칠 수 있으므로 `min-h-screen`으로 변경 고려.

### [2026-01-05] (UX 개선) 지도 뷰포트 최적화
- **요청**: 스크롤 없이 한 화면에 지도 전체가 보이도록 개선.
- **방안**: 
    1.  SVG의 `max-height`를기존 `80vh`에서 `65vh` 정도로 축소.
    2.  모바일/데스크탑 반응형 분기: 화면이 작을수록 지도를 더 작게(비율 유지) 줄여서 헤더와 겹치지 않게 함.

### [2026-01-05] (기능 추가) 랜딩 페이지 내 로그아웃
- **요청**: `script.js` 수정 없이 `landing.html` 내부에서만 로그아웃/계정전환 기능 구현.
- **구현**:
    1.  상단 유저 배지에 '로그아웃' 버튼 추가.
    2.  클릭 시 `localStorage` 클리어 후 페이지 리로드를 수행하는 인라인 스크립트 작성.

### [2026-01-05] 유저 배지 위치 이동
- **요청**: 우측 상단 -> 우측 하단으로 이동.
- **수정**: `top-6` 클래스를 `bottom-6`으로 변경.

### [2026-01-05] 소셜 로그인(OAuth) 문제 해결 완료
- **결과**: Google 및 Naver 로그인 정상 작동 확인 (사용자 검증 완료).
- **해결책**:
    1. `.env` 파일 내 Redirect URI 설정 변수명 및 경로 수정.
    2. `auth.py`에서 환경변수 로드 시 `.strip()` 처리로 공백 제거.
    3. 개발자 콘솔 Client ID 재확인 및 적용.

### [2026-01-06] Landing Page 카운팅 로직 수정
- **요청**: 모든 지역 뉴스 수량에 '전국' 뉴스 수량을 합산하여 표시.
- **수정**: `updateMapData` 함수에서 `dbCounts['전국']` 값을 추출 후, 각 지역 count에 더하도록 로직 변경.

### [2026-01-06] 툴팁 높이 및 설정 최종 조율
- **완료**: `BOTTOM_ELEVATION_Y` 설정을 통해 하단 툴팁의 높이(지도와의 간격)를 제어할 수 있도록 함.
- **설정값 적용**: 사용자가 직접 `BOTTOM_ELEVATION_Y: -20`으로 설정하여 최적의 위치를 잡음.

### 모바일 UX 개선 (바텀 시트)
- **문제**: 모바일 환경에서 툴팁은 터치 친화적이지 않아, 상세 정보를 보여주는 더 나은 UI 패턴이 필요했음.
- **해결**: "고정 바텀 시트 (Fixed Bottom Sheet)" 패턴을 구현함.
    - **인터랙션**: 모바일 기기(`width <= 768px`)에서 지역 클릭 시, 툴팁 대신 바텀 시트가 하단에서 올라옴.
    - **가림 방지 (Map Shift)**: 시트가 열릴 때 지도 컨테이너를 위로 밀어올리는 로직(`.map-shifted`)을 추가하여, 제주도와 같은 하단 지역이 시트에 가려지지 않도록 함.
    - **코드 분리**: 충돌 방지를 위해 데스크탑(`!isMobile`)과 모바일(`isMobile`)의 이벤트 리스너 로직을 명확히 분리함.
    - **닫기 로직**: 'X' 버튼 클릭 또는 지도 배경 클릭 시 시트가 닫히도록 구현.

### 헤더 페이드 로직 (모바일 UX 폴리싱)
- **문제**: 지도가 위로 밀려 올라갈 때 상단 헤더 텍스트("쓱-쓱 훑어보는...")와 지도가 겹쳐 보여 어색함.
- **해결**: 헤더 자동 숨김(Fade Out) 효과 적용.
    - **로직**: 바텀 시트가 열려서 지도가 위로 이동할 때, 헤더에 `.header-hidden` 클래스를 추가하여 투명하게 만들고 위로 숨김.
    - **복구**: 시트가 닫힐 때 헤더가 다시 부드럽게 나타나도록 처리.